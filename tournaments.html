<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Golf Cove League - Weekly Tournament</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f5f5f5;
            color: #333;
            min-height: 100vh;
        }

        /* Top Bar */
        .top-bar {
            background: #333;
            color: white;
            padding: 8px 20px;
            font-size: 13px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .top-bar a {
            color: white;
            text-decoration: none;
        }

        .top-bar a:hover {
            text-decoration: underline;
        }

        /* Header */
        header {
            background: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            color: #333;
        }

        .logo img {
            height: 50px;
        }

        .logo span {
            font-size: 24px;
            font-weight: 700;
            color: #333;
        }

        nav {
            display: flex;
            gap: 30px;
        }

        nav a {
            color: #333;
            text-decoration: none;
            font-weight: 500;
            font-size: 15px;
        }

        nav a:hover {
            color: #37b24a;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, #37b24a 0%, #2d9240 100%);
            color: white;
            padding: 60px 20px;
            text-align: center;
        }

        .hero h1 {
            font-size: 42px;
            margin-bottom: 15px;
        }

        .hero p {
            font-size: 18px;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* League Info Card */
        .league-info {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }

        .league-info h2 {
            font-size: 28px;
            color: #333;
            margin-bottom: 10px;
        }

        .league-info .season {
            color: #37b24a;
            font-size: 18px;
            font-weight: 600;
        }

        .league-info .stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: #37b24a;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        /* Quick Links */
        .quick-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .link-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            text-decoration: none;
            color: inherit;
        }

        .link-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .link-card .icon {
            width: 60px;
            height: 60px;
            background: #e8f5e9;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 28px;
        }

        .link-card h3 {
            font-size: 20px;
            margin-bottom: 10px;
            color: #333;
        }

        .link-card p {
            color: #666;
            font-size: 14px;
        }

        /* Season Standings Preview */
        .standings-preview {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 30px;
        }

        .standings-preview h2 {
            font-size: 24px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .standings-preview h2 a {
            font-size: 14px;
            color: #37b24a;
            text-decoration: none;
        }

        .standings-preview h2 a:hover {
            text-decoration: underline;
        }

        /* Top 3 Podium */
        .podium {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 15px;
            margin-bottom: 30px;
        }

        .podium-place {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            background: #f8f9fa;
            min-width: 120px;
        }

        .podium-place.first {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: white;
            transform: scale(1.1);
            order: 2;
        }

        .podium-place.second {
            background: linear-gradient(135deg, #C0C0C0 0%, #A8A8A8 100%);
            color: white;
            order: 1;
        }

        .podium-place.third {
            background: linear-gradient(135deg, #CD7F32 0%, #B8860B 100%);
            color: white;
            order: 3;
        }

        .podium-rank {
            font-size: 24px;
            font-weight: 700;
        }

        .podium-name {
            font-size: 16px;
            font-weight: 600;
            margin-top: 10px;
        }

        .podium-score {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 5px;
        }

        /* Standings Table */
        .standings-table {
            width: 100%;
            border-collapse: collapse;
        }

        .standings-table th,
        .standings-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .standings-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        .standings-table tr:hover {
            background: #f8f9fa;
        }

        .standings-table .pos {
            width: 50px;
            font-weight: 700;
            color: #37b24a;
        }

        /* Current Round */
        .current-round {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 30px;
        }

        .current-round h2 {
            font-size: 24px;
            margin-bottom: 20px;
        }

        .round-badge {
            display: inline-block;
            background: #37b24a;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            margin-left: 10px;
        }

        .no-data {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .no-data .icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        /* Admin Link */
        .admin-link {
            text-align: center;
            margin-top: 30px;
        }

        .admin-link a {
            color: #666;
            text-decoration: none;
            font-size: 14px;
        }

        .admin-link a:hover {
            color: #37b24a;
        }

        /* Footer */
        footer {
            background: #333;
            color: white;
            padding: 40px 20px;
            margin-top: 60px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
        }

        .footer-section h4 {
            font-size: 16px;
            margin-bottom: 15px;
            color: #37b24a;
        }

        .footer-section a {
            color: #ccc;
            text-decoration: none;
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .footer-section a:hover {
            color: white;
        }

        .footer-bottom {
            max-width: 1200px;
            margin: 30px auto 0;
            padding-top: 20px;
            border-top: 1px solid #444;
            text-align: center;
            color: #888;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            nav {
                display: none;
            }

            .hero h1 {
                font-size: 28px;
            }

            .league-info .stats {
                gap: 20px;
            }

            .podium {
                flex-direction: column;
                align-items: center;
            }

            .podium-place {
                order: unset !important;
                transform: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- Top Bar -->
    <div class="top-bar">
        <span>üìç 100 Old Woodend Rd, Cromwell, CT 06416</span>
        <span><a href="tel:860-632-0330">üìû 860-632-0330</a></span>
    </div>

    <!-- Header -->
    <header>
        <a href="index.html" class="logo">
            <img src="images/logo.png" alt="Golf Cove Logo">
            <span>Golf Cove</span>
        </a>
        <nav>
            <a href="index.html">Home</a>
            <a href="about.html">About</a>
            <a href="lessons.html">Lessons</a>
            <a href="tournaments.html" style="color: #37b24a;">League</a>
            <a href="contact.html">Contact</a>
        </nav>
    </header>

    <!-- Hero -->
    <section class="hero">
        <h1>Golf Cove League</h1>
        <p>Join our weekly league and compete for season standings. Track your scores, see where you rank, and earn your spot in the playoffs!</p>
    </section>

    <!-- Main Content -->
    <div class="container">
        <!-- League Info -->
        <div class="league-info" id="leagueInfo">
            <h2 id="leagueName">Golf Cove Weekly League</h2>
            <div class="season" id="seasonName">2025 Season</div>
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="totalPlayers">0</div>
                    <div class="stat-label">Players</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="totalRounds">0</div>
                    <div class="stat-label">Rounds Played</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="currentRound">0</div>
                    <div class="stat-label">Current Week</div>
                </div>
            </div>
        </div>

        <!-- Quick Links -->
        <div class="quick-links">
            <a href="league-standings.html" class="link-card">
                <div class="icon">üèÜ</div>
                <h3>Season Standings</h3>
                <p>View full season standings with cumulative scores and round-by-round breakdown</p>
            </a>
            <a href="score.html" class="link-card">
                <div class="icon">‚õ≥</div>
                <h3>Enter Scores</h3>
                <p>Record your scores for the current round using our mobile-friendly scorecard</p>
            </a>
            <a href="league-admin.html" class="link-card">
                <div class="icon">‚öôÔ∏è</div>
                <h3>League Admin</h3>
                <p>Manage league settings, add rounds, and configure players (Admin only)</p>
            </a>
        </div>

        <!-- Season Standings Preview -->
        <div class="standings-preview">
            <h2>
                Season Leaders
                <a href="league-standings.html">View Full Standings ‚Üí</a>
            </h2>
            
            <div id="podiumContainer">
                <div class="no-data">
                    <div class="icon">üèåÔ∏è</div>
                    <p>No scores recorded yet. Start a new round to see standings!</p>
                </div>
            </div>

            <table class="standings-table" id="standingsTable" style="display: none;">
                <thead>
                    <tr>
                        <th class="pos">#</th>
                        <th>Player</th>
                        <th>Rounds</th>
                        <th>Total Net</th>
                        <th>Avg</th>
                    </tr>
                </thead>
                <tbody id="standingsBody">
                </tbody>
            </table>
        </div>

        <!-- Current Round -->
        <div class="current-round">
            <h2>
                Current Round
                <span class="round-badge" id="currentRoundBadge">Week 1</span>
            </h2>
            <div id="currentRoundContent">
                <div class="no-data">
                    <div class="icon">üìÖ</div>
                    <p>No active round. Check back when the next round begins!</p>
                </div>
            </div>
        </div>

        <!-- Admin Link -->
        <div class="admin-link">
            <a href="league-admin.html">üîí League Administration</a>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h4>Golf Cove</h4>
                <a href="index.html">Home</a>
                <a href="about.html">About Us</a>
                <a href="contact.html">Contact</a>
            </div>
            <div class="footer-section">
                <h4>Activities</h4>
                <a href="lessons.html">Lessons</a>
                <a href="tournaments.html">League</a>
                <a href="camps.html">Camps</a>
            </div>
            <div class="footer-section">
                <h4>Contact</h4>
                <a href="tel:860-632-0330">860-632-0330</a>
                <a href="mailto:info@golfcovect.com">info@golfcovect.com</a>
            </div>
        </div>
        <div class="footer-bottom">
            ¬© 2025 Golf Cove. All rights reserved.
        </div>
    </footer>

    <script>
        // Load league data and display
        function loadLeagueData() {
            const league = JSON.parse(localStorage.getItem('golfcove_league') || 'null');
            const scores = JSON.parse(localStorage.getItem('golfcove_scores') || '[]');

            if (league) {
                document.getElementById('leagueName').textContent = league.name || 'Golf Cove Weekly League';
                document.getElementById('seasonName').textContent = league.season || '2025 Season';
                
                // Calculate stats
                const players = league.players || [];
                const rounds = league.rounds || [];
                
                document.getElementById('totalPlayers').textContent = players.length;
                document.getElementById('totalRounds').textContent = rounds.length;
                document.getElementById('currentRound').textContent = rounds.length;
                document.getElementById('currentRoundBadge').textContent = `Week ${rounds.length || 1}`;

                // Calculate standings
                if (scores.length > 0 && players.length > 0) {
                    const standings = calculateStandings(players, scores, rounds);
                    displayPodium(standings);
                    displayStandings(standings);
                }

                // Show current round info
                if (rounds.length > 0) {
                    displayCurrentRound(rounds[rounds.length - 1], scores);
                }
            }
        }

        function calculateStandings(players, scores, rounds) {
            const standings = players.map(player => {
                const playerScores = scores.filter(s => s.playerId === player.id);
                const completedRounds = playerScores.filter(s => s.totalGross > 0);
                
                let totalGross = 0;
                let totalNet = 0;

                completedRounds.forEach(score => {
                    totalGross += score.totalGross || 0;
                    // Calculate net (gross - handicap allowance per round)
                    const handicapAllowance = Math.round((player.handicap || 0) * 0.9);
                    totalNet += (score.totalGross || 0) - handicapAllowance;
                });

                return {
                    ...player,
                    roundsPlayed: completedRounds.length,
                    totalGross,
                    totalNet,
                    average: completedRounds.length > 0 ? Math.round(totalNet / completedRounds.length) : 0
                };
            });

            // Sort by total net (lowest wins)
            return standings.sort((a, b) => {
                if (a.roundsPlayed === 0 && b.roundsPlayed === 0) return 0;
                if (a.roundsPlayed === 0) return 1;
                if (b.roundsPlayed === 0) return -1;
                return a.totalNet - b.totalNet;
            });
        }

        function displayPodium(standings) {
            const container = document.getElementById('podiumContainer');
            const qualifiedPlayers = standings.filter(s => s.roundsPlayed > 0).slice(0, 3);

            if (qualifiedPlayers.length === 0) {
                return;
            }

            let html = '<div class="podium">';
            
            const places = ['first', 'second', 'third'];
            qualifiedPlayers.forEach((player, index) => {
                html += `
                    <div class="podium-place ${places[index]}">
                        <div class="podium-rank">${index + 1}</div>
                        <div class="podium-name">${player.name}</div>
                        <div class="podium-score">${player.totalNet > 0 ? '+' + player.totalNet : player.totalNet} net</div>
                    </div>
                `;
            });

            html += '</div>';
            container.innerHTML = html;
        }

        function displayStandings(standings) {
            const table = document.getElementById('standingsTable');
            const tbody = document.getElementById('standingsBody');
            
            const qualifiedPlayers = standings.filter(s => s.roundsPlayed > 0);
            
            if (qualifiedPlayers.length === 0) {
                return;
            }

            table.style.display = 'table';
            
            tbody.innerHTML = qualifiedPlayers.slice(0, 10).map((player, index) => `
                <tr>
                    <td class="pos">${index + 1}</td>
                    <td>${player.name}</td>
                    <td>${player.roundsPlayed}</td>
                    <td>${player.totalNet > 0 ? '+' + player.totalNet : player.totalNet}</td>
                    <td>${player.average > 0 ? '+' + player.average : player.average}</td>
                </tr>
            `).join('');
        }

        function displayCurrentRound(round, scores) {
            const container = document.getElementById('currentRoundContent');
            const roundScores = scores.filter(s => s.roundId === round.id);
            const inProgress = roundScores.filter(s => s.currentHole > 0 && s.currentHole <= 18);
            const completed = roundScores.filter(s => s.totalGross > 0);

            if (roundScores.length === 0) {
                container.innerHTML = `
                    <div class="no-data">
                        <div class="icon">üìÖ</div>
                        <p>Round scheduled for ${new Date(round.date).toLocaleDateString()}. No scores yet.</p>
                    </div>
                `;
                return;
            }

            let html = `
                <p style="margin-bottom: 15px; color: #666;">
                    üìÖ ${new Date(round.date).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' })}
                    &nbsp;|&nbsp; ${inProgress.length} in progress &nbsp;|&nbsp; ${completed.length} completed
                </p>
                <table class="standings-table">
                    <thead>
                        <tr>
                            <th>Player</th>
                            <th>Status</th>
                            <th>Thru</th>
                            <th>Score</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            roundScores.forEach(score => {
                const league = JSON.parse(localStorage.getItem('golfcove_league') || '{}');
                const player = (league.players || []).find(p => p.id === score.playerId);
                const playerName = player ? player.name : 'Unknown';
                
                let status = 'Not Started';
                let thru = '-';
                let scoreDisplay = '-';

                if (score.totalGross > 0) {
                    status = 'Complete';
                    thru = '18';
                    scoreDisplay = score.totalGross;
                } else if (score.currentHole > 0) {
                    status = 'In Progress';
                    thru = score.currentHole - 1;
                    const currentTotal = (score.holes || []).reduce((sum, h) => sum + (h || 0), 0);
                    scoreDisplay = currentTotal || '-';
                }

                html += `
                    <tr>
                        <td>${playerName}</td>
                        <td>${status}</td>
                        <td>${thru}</td>
                        <td>${scoreDisplay}</td>
                    </tr>
                `;
            });

            html += '</tbody></table>';
            container.innerHTML = html;
        }

        // Load data on page load
        loadLeagueData();

        // Auto-refresh every 30 seconds
        setInterval(loadLeagueData, 30000);
    </script>
</body>
</html>
